---
title: "Assignment 4"
author: "Roshni Katrak-Adefowora and Genevieve Chiong"
date: "2/23/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(purrr)
library(ggpubr)

source("../R/kit_fox_resistance.R")
```

```{r}
# For Loop
possible_landcover <- data.frame(landcover = c("Grassland and Herbaceous", "Pasture", "Urban", "Fallowed", "Roads"),
                suitability_score = c(80, 30, 20, 50, 0))

sensitivity <- c(0.25, 0.5, 1)

resistance1 <- as.data.frame(matrix(nrow = length(sensitivity),
                                   ncol = nrow(possible_landcover)))

for (i in 1:nrow(possible_landcover)) {
  resistance1[,i] = kit_fox_resistance(h = possible_landcover$suitability_score[i], c = sensitivity)
}

colnames(resistance1) <- possible_landcover$landcover
rownames(resistance1) <- sensitivity

resistance1r <- resistance1 %>% pivot_longer(cols = everything(),
                                             names_to = "landcover", 
                                             values_to = "resistance") 

resistance1r_plot <- ggplot(data = resistance1r, 
                       aes(x = landcover,
                           y = resistance, 
                           fill = landcover)) + 
  geom_col() +
  ggtitle("For Loop")

resistance1r_plot

```

```{r}
# Pmap

resistance_pmap <- pmap(list(h = landcover$suitability_score), 
                        kit_fox_resistance,
                        c = sensitivity)
powerall2 <- pmap(list(A = possible_cars$area, m=possible_cars$mass), 
                  auto_power_gen, 
                  V=speeds)

powerall2 <- as.data.frame(powerall2, col.names = possible_cars$name) 
#resistance_pmap2 <- as.data.frame(resistance_pmap, col.names = landcover$land_cover)

resistance_pmap2 <- as.data.frame(matrix(nrow = length(sensitivity),
                                   ncol = nrow(landcover)))

resistance_pmap2r <- resistance_pmap2 %>% pivot_longer(cols = everything(),
                                                       names_to = "landcover",
                                                       values_to = "resistance")

method2_plot <-  ggplot(data = resistance_pmap2r, 
                        aes(x = ,
                            y = power, 
                            fill=car)) + 
  geom_point() + 
  ggtitle("Pmap")

```







